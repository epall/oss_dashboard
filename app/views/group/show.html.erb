<html>
    <head>
      <title><%= @group.name %> Dashboard</title>
        <script src="http://www.google.com/jsapi"></script>
        <script type="text/javascript">
          google.load("jquery", "1");
          google.load("jqueryui", "1");
          google.setOnLoadCallback(function(){
              $('.edit_link').hide();
              $('td.name').mouseenter(function(){
                $(this).find('.edit_link').show('blind');
                });
              $('td.name').mouseleave(function(){
                $(this).find('.edit_link').hide('blind');
                });
              });
        </script>
        <style type="text/css">
          table {
            margin-right: 1em;
          }

          h1 {
            text-align: center;
          }
            th {
                font-weight: bold;
                font-size: large;
                padding-left: 0.5em;
                padding-right: 0.5em;
                padding-top: 5px;
                padding-bottom: 5px;
            }

            td {
                padding:0.25em;
                text-align: center;
            }

            td.no {
                background-color: red;
            }

            td.yes {
                background-color: #3F3;
            }

            #description > p {
              width:60%;
            }

            #stats {
              float: right;
              width: 40%;
              margin-left: 5em;
            }

            #stats p {
              margin: 0px;
            }

            #stats ul {
              margin: 0px;
            }

            .edit_link form {
              margin:0px;
            }
              
            .menu {
              text-align: center;
            }
        </style>
    </head>
    <body>
        <h1><%= @group.name %> Dashboard</h1>
        <div class="menu">
          <%= link_to 'Add project', :controller => :project, :action => :new %> |
          <%= link_to 'Blog aggregate', :controller => :events %> |
          <%= link_to 'Update', :controller => :project, :action => :fetch %> |
          <%= link_to 'Admin', :action => :admin, :id => @group.id %>
        </div>
        <div id="description">
          <div id="stats">
            <p>Of the <b><%= @stats['num_projects'] %></b> projects active in <%= @group.name %> this semester,</p>
            <ul>
              <li><b><%= @stats['all_three'] %></b> have posted a blog, source code, and a wiki</li>
              <li><b><%= @stats['last_week'] %></b> have updated in the last week</li>
              <li><b><%= @stats['none'] %></b> have not posted anything yet</li>
            </ul>
          </div>
          <p><%= @group.description %></p>
        </div>
        <table border="1">
            <tr>
                <% Project.display_columns.map{|name| name.gsub('_', ' ').capitalize}.each do |col| %>
                    <th><%= col %></th>
                <% end %>
            </tr>

            <% @projects.each do |project| %>
                <tr>
                    <% Project.display_columns.each do |col| %>
                      <td class="<%= value_class(col, project) %>"
                        style="<%= value_style(col, project)%>">
                        <%= column_contents(col, project) %>
                      </td>
                    <% end %>
                </tr>
            <% end %>
        </table>
    </body>
</html>
